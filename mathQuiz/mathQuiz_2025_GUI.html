<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Mad Minutes Math Quiz</title>
  <style>
    :root {
      --pastel-pink: #ffd1dc;
      --pastel-blue: #b5dafe;
      --accent-pink: #ffb3c6;
      --accent-blue: #a3c9f9;
      --text-main: #000;
      --text-light: #000;
    }
    body {
      font-family: Arial, sans-serif;
      max-width: 500px;
      margin: 40px auto;
      background: linear-gradient(135deg, var(--pastel-pink) 0%, var(--pastel-blue) 100%);
      padding: 2em;
      border-radius: 18px;
      box-shadow: 0 4px 24px 0 rgba(176, 187, 215, 0.16);
      color: var(--text-main);
    }
    h2 {
      color: #000;
      background: var(--accent-pink);
      padding: 0.4em 0.8em;
      border-radius: 8px;
      display: inline-block;
      margin-bottom: 0.7em;
      box-shadow: 0 2px 8px #ffd1dc44;
    }
    label, p {
      font-size: 1.1em;
      color: var(--text-light);
    }
    input[type="number"], input[type="text"] {
      width: 90px;
      margin: 0 5px 10px 0;
      border: 1.5px solid var(--accent-blue);
      border-radius: 6px;
      padding: 0.3em 0.5em;
      font-size: 1.08em;
      background: #fffafd;
      transition: border-color 0.2s;
      color: #000;
    }
    input[type="number"]:focus, input[type="text"]:focus {
      border-color: var(--accent-pink);
      outline: none;
      background: #fff4fa;
      color: #000;
    }
    #quiz-section, #result-section { display: none; }
    .correct { color: #42a07b; }
    .wrong { color: #cd4a66; }
    #question {
      font-size: 1.5em;
      margin: 1.2em 0 0.5em 0;
      color: #000;
      font-weight: bold;
      letter-spacing: 1px;
      background: var(--pastel-pink);
      border-radius: 7px;
      padding: 0.4em 0.7em;
      box-shadow: 0 1px 6px #b5dafe33;
      display: inline-block;
    }
    #feedback {
      margin: 1em 0 0.5em 0;
      font-weight: 500;
      color: #000;
    }
    #score {
      margin-top: 0.5em;
      color: #000;
      font-weight: bold;
    }
    button {
      padding: 0.5em 1.3em;
      margin: 0.5em 0.5em 0.5em 0;
      border-radius: 6px;
      border: none;
      background: linear-gradient(90deg, var(--accent-pink), var(--accent-blue));
      color: #000;
      font-size: 1em;
      font-weight: bold;
      box-shadow: 0 2px 8px #ffd1dc22;
      cursor: pointer;
      transition: background 0.2s, color 0.2s;
    }
    button:hover, button:focus {
      background: linear-gradient(90deg, var(--accent-blue) 40%, var(--accent-pink));
      color: #000;
    }
    #setup-section, #result-section {
      background: #fffafdcc;
      border-radius: 10px;
      padding: 1.1em 1.3em 1.5em 1.3em;
      box-shadow: 0 2px 10px #b5dafe18;
      color: #000;
    }
    #setup-error, #feedback {
      min-height: 1.5em;
      margin-bottom: 0.5em;
      transition: color 0.2s;
    }
    #final-score {
      font-size: 1.2em;
      color: var(--accent-pink);
      font-weight: bold;
    }
    @media (max-width: 600px) {
      body { padding: 1em; }
      h2 { font-size: 1.15em; }
    }
  </style>
</head>
<body>
  <h2>Mad Minutes Quiz. Bienvenue.</h2>
  <p>*****<br>
  Answer non-integer answers to <strong>1 decimal place</strong>.<br>
  To end the quiz, type <code>end</code>.<br>
  *****</p>

  <div id="setup-section">
    <label>
      Our examinee today is:
      <input type="text" id="username" required>
    </label>
    <br>
    <p>Input the range of numbers you would like to be quizzed on.</p>
    <label>
      Smallest number:
      <input type="number" id="min" required>
    </label>
    <label>
      Largest number:
      <input type="number" id="max" required>
    </label>
    <br>
    <button onclick="startQuiz()">Let's Begin!</button>
    <div id="setup-error" class="wrong"></div>
  </div>

  <div id="quiz-section">
    <div id="question"></div>
    <input type="text" id="answer" autocomplete="off" placeholder="Your answer or 'end'">
    <button onclick="submitAnswer()">Submit</button>
    <div id="feedback"></div>
    <div id="score"></div>
  </div>

  <div id="result-section">
    <h3>End of Quiz.</h3>
    <p id="final-score"></p>
    <button onclick="location.reload()">Restart</button>
  </div>

<script>
let min, max, username;
let score = 0, total_q = 0;
let r1, r2, opr, ans;
const ops = {
  '+': (a, b) => a + b,
  '-': (a, b) => a - b,
  '*': (a, b) => a * b,
  '/': (a, b) => a / b
};
const wrongMessages = [
  (a) => `Uh oh. It was ${a}. Try again.`,
  "Not according to this dimension's mathematics.",
  (a) => `Um, it's actually ${a}...`,
  "Would you like to phone a friend?",
];

function startQuiz() {
  document.getElementById('setup-error').textContent = '';
  username = document.getElementById('username').value.trim();
  min = parseInt(document.getElementById('min').value, 10);
  max = parseInt(document.getElementById('max').value, 10);

  if (!username) {
    document.getElementById('setup-error').textContent = "Please enter your name.";
    return;
  }
  if (isNaN(min) || isNaN(max) || min >= max-1) {
    document.getElementById('setup-error').textContent = "Please try again. Enter your range as whole numbers that are at least 2 digits apart.";
    return;
  }

  score = 0; total_q = 0;
  document.getElementById('setup-section').style.display = 'none';
  document.getElementById('quiz-section').style.display = 'block';
  nextQuestion();
}

function nextQuestion() {
  // r1 in [min+1, max], r2 in [min, r1-1], so r2 always < r1
  r1 = getRandomInt(min+1, max+1); // inclusive
  r2 = getRandomInt(min, r1);
  opr = randomChoice(Object.keys(ops));
  ans = ops[opr](r1, r2);
  ans = Math.round(ans * 10) / 10; // 1 decimal place

  // For division, ensure denominator is not 0 and result is not too long
  if (opr === '/' && r2 === 0) {
    nextQuestion();
    return;
  }
  document.getElementById('question').textContent = `${r1} ${opr} ${r2} = ?`;
  document.getElementById('answer').value = '';
  document.getElementById('feedback').textContent = '';
  updateScore();
  document.getElementById('answer').focus();
}

function submitAnswer() {
  const input = document.getElementById('answer').value.trim();
  if (input.toLowerCase() === 'end') {
    endQuiz();
    return;
  }
  total_q++;
  let userAns = Number(input);

  if (isNaN(userAns)) {
    document.getElementById('feedback').textContent = "This is not imaginary math. Numbers only, please.";
    document.getElementById('feedback').className = "wrong";
    total_q--; // do not count invalid input toward total questions
    return;
  }

  if (Math.abs(userAns - ans) < 0.09) { // floating pt tolerance for 1 decimal place
    score++;
    document.getElementById('feedback').textContent = "...correct.";
    document.getElementById('feedback').className = "correct";
  } else {
    let msg = randomChoice(wrongMessages);
    if (typeof msg === "function") msg = msg(ans);
    document.getElementById('feedback').textContent = msg;
    document.getElementById('feedback').className = "wrong";
  }
  updateScore();
  setTimeout(nextQuestion, 900);
}

function endQuiz() {
  document.getElementById('quiz-section').style.display = 'none';
  document.getElementById('result-section').style.display = 'block';
  document.getElementById('final-score').textContent = `${username}'s Grade: ${score}/${total_q}`;
}

// Utility helpers
function getRandomInt(min, max) { // [min, max)
  return Math.floor(Math.random() * (max - min)) + min;
}
function randomChoice(arr) {
  return arr[Math.floor(Math.random() * arr.length)];
}
function updateScore() {
  document.getElementById('score').textContent = `Score: ${score} / ${total_q}`;
}

// Allow pressing Enter to submit answer
document.getElementById('answer').addEventListener('keyup', function(e) {
  if (e.key === 'Enter') submitAnswer();
});
</script>
</body>
</html>